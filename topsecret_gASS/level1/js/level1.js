class Level1 extends BaseLevel {
    constructor() {
        const config = {
            rows: 7,
            cols: 5,
            hasRedZones: true
        };
        super(config);

        // Переопределяем контент для уровня 1
       this.RED_ZONE_QUESTIONS = [
           {
               q: "Кто-то звонит и просит данные карты. Что делать?",
               answers: [
                   { text: "Повесить трубку и позвонить в банк", correct: true },
                   { text: "Назвать номер карты и код", correct: false },
                   { text: "Спросить у звонящего, прошёл ли платёж", correct: false }
               ]
           },
           {
               q: "Вы получаете письмо с ссылкой на «срочное обновление счёта банка». Что делать?",
               answers: [
                   { text: "Не переходить по ссылке и проверить информацию через официальный сайт банка", correct: true },
                   { text: "Кликнуть по ссылке и ввести данные", correct: false },
                   { text: "Ответить на письмо и уточнить, зачем им ваши данные", correct: false }
               ]
           },
           {
               q: "В соцсети приходит сообщение «Вы выиграли крупную сумму, отправьте реквизиты».",
               answers: [
                   { text: "Ответить, уточняя, какой банк организовал акцию", correct: false },
                   { text: "Отправить реквизиты и подтвердить выигрыш", correct: false },
                   { text: "Игнорировать сообщение и удалить его", correct: true }
               ]
           },
           {
               q: "Незнакомец просит перевести деньги на «безопасный счёт» для проверки вашей карты.",
               answers: [
                   { text: "Попросить у него контакты и договориться позже", correct: false },
                   { text: "Перевести, чтобы «не потерять счёт»", correct: false },
                   { text: "Не переводить и сообщить в банк", correct: true }
               ]
           },
           {
               q: "Приходит SMS с кодом подтверждения, который вы не запрашивали.",
               answers: [
                   { text: "Переслать код знакомому", correct: false },
                   { text: "Ввести код на сайте, чтобы проверить", correct: false },
                   { text: "Не вводить код никуда и сообщить в банк", correct: true }
               ]
           },
           {
               q: "Вам звонят и представляются сотрудниками банка, требуют срочно сообщить ПИН.",
               answers: [
                   { text: "Сообщить ПИН, чтобы «не заблокировали карту»", correct: false },
                   { text: "Закончить разговор и перезвонить в банк самостоятельно", correct: true },
                   { text: "Спросить имя менеджера и продолжить разговор", correct: false }
               ]
           },
           {
               q: "К вам подходит «курьер» и просит отдать карту для «обновления терминала».",
               answers: [
                   { text: "Отдать карту, доверяя курьеру", correct: false },
                   { text: "Не отдавать карту и позвонить в банк", correct: true },
                   { text: "Спросить курьера, почему нельзя сделать онлайн", correct: false }
               ]
           },
           {
               q: "Приходит сообщение о «задолженности», с угрозой блокировки счёта.",
               answers: [
                   { text: "Перевести деньги на предложенный счёт", correct: false },
                   { text: "Игнорировать и проверить долг через официальный канал", correct: true },
                   { text: "Ответить на сообщение и договориться", correct: false }
               ]
           },
           {
               q: "На улице незнакомец предлагает помощь с банкоматом и просит вашу карту.",
               answers: [
                   { text: "Отдать карту на минуту", correct: false },
                   { text: "Позволить, чтобы «помог»", correct: false },
                   { text: "Отказаться и не показывать карту", correct: true }
               ]
           },
           {
               q: "Приходит электронное письмо с вложением «счёт-фактура».",
               answers: [
                   { text: "Не открывать вложение и проверить отправителя", correct: true },
                   { text: "Скачать и открыть вложение", correct: false },
                   { text: "Ответить на письмо и попросить другие документы", correct: false }
               ]
           },
           {
               q: "В соцсети предлагают «инвестиции с гарантированной доходностью».",
               answers: [
                   { text: "Не отправлять деньги и проверить компанию", correct: true },
                   { text: "Вложить деньги сразу", correct: false },
                   { text: "Отправить часть денег для проверки", correct: false }
               ]
           },
           {
               q: "Получаете звонок с номером банка, но телефон подозрительный.",
               answers: [
                   { text: "Перезвонить на официальный номер банка", correct: true },
                   { text: "Ответить и сообщить все данные", correct: false },
                   { text: "Игнорировать звонок, но написать в чат банка", correct: false }
               ]
           },
           {
               q: "Вам приходит QR-код для оплаты «штрафа», который вы не получали.",
               answers: [
                   { text: "Не сканировать QR-код и проверить штраф через госуслуги", correct: true },
                   { text: "Сканировать и оплатить", correct: false },
                   { text: "Переслать QR-код знакомому", correct: false }
               ]
           },
           {
               q: "Вам пишут в мессенджере якобы «сотрудники банка» и просят прислать фото паспорта.",
               answers: [
                   { text: "Не присылать фото и связаться с банком напрямую", correct: true },
                   { text: "Прислать фото, чтобы «подтвердить личность»", correct: false },
                   { text: "Отправить только скан первой страницы", correct: false }
               ]
           },
           {
               q: "Звонят и обещают «возврат налога» при условии предоставления данных карты.",
               answers: [
                   { text: "Не предоставлять данные и проверить через налоговую", correct: true },
                   { text: "Дать данные, чтобы получить возврат", correct: false },
                   { text: "Спросить реквизиты банка и уточнить, кто звонит", correct: false }
               ]
           }
       ];


        this.DIALOGS = [
            'В нашем мире все деньги это единый газовый поток. Мы называем его ФинГаз.',
            'Видишь эту трубу? По ней текут твои сбережения.',
            'У каждого из нас есть мечта. Собери путь из труб к мечте!',
            'Твоя задача: собрать путь из труб к мечте. ',
            'Для этого используй трубы в нижней части экрана.',
        ];

        this.FIRST_PIPE_DIALOGS = [
            "Ох. Видишь эту красную зону?",
            "Это скопление мошенников, которые ну очень хотят украсть твои накопления. ",
            "Попав в такую тебе придется выбрать правильную тактику общения с ними, а иначе потеряешь часть ФинГаза и Газики.",
            "Запомни: чем больше потока дойдет до мечты – тем больше Рубликов ты получишь. ",
            "Позже я объясню зачем они нужны. Удачи, дорогой друг!"
        ];

        this.SPECIAL_ZONE_POSITIONS = [
            [5, 2], [4, 1], [3, 3], [2, 0], [1, 3], [3, 4]
        ];

        // Явно вызываем инициализацию после установки всех свойств
        this.init();
    }

    getNextLevelPath() {
        return '../level2/level2.html';
    }
}

// Инициализация уровня
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM loaded, initializing Level1...');
    currentLevel = new Level1();

    // Кнопки "Следующий уровень"
    const nextLevelButtons = [
            document.getElementById('nextLevel'),       // dailyModal
        ];

        nextLevelButtons.forEach(btn => {
            if (btn) {
                btn.addEventListener('click', () => {
                    if (currentLevel) {
                        currentLevel.goToNextLevel();
                    }
                });
            }
        });

    // Глобальная функция для выбора трубы
    window.choosePipe = function(type) {
        console.log('Choosing pipe:', type);
        if (currentLevel) {
            currentLevel.choosePipe(type);
        }
    };

    // Адаптация layout
    if (currentLevel) {
        currentLevel.adjustLayoutForViewport();
    }
    window.addEventListener('resize', () => {
        if (currentLevel) {
            currentLevel.adjustLayoutForViewport();
        }
    });

    console.log('Level1 initialization complete');
});